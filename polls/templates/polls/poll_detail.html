{% extends "base.html" %}
{% load i18n %}

{% block content %}
<h1>{{ poll.question }}</h1>

<!-- Display any messages sent from the server, such as success or error messages. -->
{% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <!-- Each message has tags like 'success' or 'error' that help with styling. -->
            <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}

<!-- If the poll is inactive, show a message instead of the voting options. -->
{% if not poll.active %}
    <p>{% trans "This poll is currently inactive. You cannot vote in this poll." %}</p>

<!-- If the poll is active and the user hasn't voted yet, show the voting form. -->
{% elif poll.votable %}
    <form method="post">
        {% csrf_token %} <!-- A security token to prevent malicious attacks on the form. -->

        <!-- Loop through each choice available for the poll and display it as a radio button. -->
        {% for choice in choices %}
            <label class="radio">
                <!-- 'choice_pk' is the name of the radio input, which represents the selected choice. -->
                <input type="radio" name="choice_pk" value="{{ choice.id }}"> {{ choice.choice }}
            </label><br>
        {% endfor %}

        <!-- Button to submit the selected choice. -->
        <button type="submit" class="btn btn-primary">{% trans "Vote" %}</button>
    </form>

<!-- If the user has already voted in the poll, show a message and the results instead of the form. -->
{% else %}
    <p>{% trans "You have already voted in this poll." %}</p>
    <ul>
        <!-- Display each choice along with the number of votes it has received. -->
        {% for choice in poll.choice_set.all %}
            <li>{{ choice.choice }} - {{ choice.count_votes }} votes</li>
        {% endfor %}
    </ul>
{% endif %}
{% endblock %}


